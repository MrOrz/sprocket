# Class `Sprocket`

Instance that can be created by:

```javascript
var Sprocket = require('sprocket');
var sprocket = Sprocket();// instance created with conventions
```

or

```javascript
var Sprocket = require('sprocket');
/*
 * create without conventions.
 * you have to call registerHandler yourself.
 */
var sprocket = new Sprocket.Sprocket();
```

## Prototype methods

### sprocket.registerHandler(ancestor, extnames, handler)

#### ancestor
Type: `String`

Currently only `javascripts` and `stylesheets` are allowed.

#### extnames
Type: `Array` of `String`s

The extension names that would compiled to the ancestor by `handler`. Say:

```javascript
ancestor = 'javascripts';
extnames = ['coffee'];
```

#### handler(environment, src, dest)
Type: `Function`

The handler would serve as a factory method to link the `src` stream to `dest`

```javascript
function livescriptHandler(environment, src, dest) {
  // Generated by LiveScript 1.2.0
  var gulpLivescript = require('gulp-livescript');
  src.pipe(gulpLivescript()).pipe(dest);
}
```


### sprocket.createJavascriptsStream()

Alias of `sprocket.createStream('javascripts')`


### sprocket.createStylesheetsStream()

Alias of `sprocket.createStream('stylesheets')`


### sprocket.createStream(ancestor)

Return a stream that would resolve dependencies and compile, lint and concat assets.

**Notice:** The dependencies resolution of directives **only limits** to the files you're passing in. i.e, sprocket DON'T use `fs` to read/find files. You have to `glob` in all the assets that would later be required.

```javascript
gulp.task('js', function(){
  return gulp.src([
    'client/javascripts/**/*.ls',
    'client/javascripts/**/*.js',
    'bower_components/**/*.js'
  ]).pipe(sprocket.createJavascriptsStream()
  ).pipe(gulp.dest('tmp/public'));
});
```

**Notice:** Sprocket directives are using relative path.

Say, you have `bower_components/jquery/dist/jquery.js` installded and use the above `js` task.
In your `application.js` header:

```javascript
//= require jquery/dist/jquery
```

If you want to require the precompiled assets located in `bower_components/angular/angular.min.js`:

```javascript
/*
 *= require angular/angular.min
 */
```

Please notice they're **different**. In the former one, sprocket will minify `jquery`. In contrast, sprocket will use minified version of `angularjs` and won't minify agian.

It's recommended to require minified libraries directly since it could save your time and get a better code for libraries who use *Google Closure Compiler* like `angularjs`.


#### ancestor
Type: `String`

Currently only value `javascripts` or `stylesheets` are allowed.


### sprocket.createViewHelpers(options)

This would return a [helper object](#helper-object) that can serve as `locals` in building htmls.

#### options
Type: `Object`

##### options.assetsPath
Type: `String`
Default: `/`

Prepend to the path of assets when generating `<script></script>` and `<link>` tags.

##### options.indent
Type: `String`
Default: `    `(four spaces)

Prepend to the tags so that it would indent correctly after comiplation.
Default value is four spaces since we use 2 space for indent and `html->(head/body)->tag` has 2 level of indent (2x2 = 4).


### helper object

A object returned by [sprocket.createViewHelpers(options)](#sprocketcreateviewhelpersoptions). You can freely extend/modify the helper object since these functions are bounded.

#### javascriptIncludeTag(filename) / javascript_include_tag(filename)
Type: `Function`

Yes, underscored versions are also provided.

It would create a (list of) `<script></script>` tag(s) so that the generated html could references to the right assets.

```jade
html
  head
    != javascriptIncludeTag("application")
```

##### filename
Type: `String`

**Notice:** Sprocket directives are using relative path.  

It should relative to your globbing paths.


#### stylesheetLinkTag(filename) / stylesheet_link_tag(filename)
Type: `Function`

It would create a (list of) `<link>` tag(s) so that the generated html could references to the right assets.

##### filename
Type: `String`

**Notice:** Sprocket directives are using relative path.  

It should relative to your globbing paths.

```jade
html
  head
    != stylesheet_link_tag("application")
```